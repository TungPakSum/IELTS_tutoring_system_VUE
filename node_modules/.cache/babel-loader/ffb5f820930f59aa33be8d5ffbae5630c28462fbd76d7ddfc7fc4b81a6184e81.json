{"ast":null,"code":"import \"core-js/modules/es.function.name.js\";\nimport { createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, vModelSelect as _vModelSelect, withDirectives as _withDirectives, vModelText as _vModelText, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nvar _withScopeId = function _withScopeId(n) {\n  return _pushScopeId(\"data-v-7573f9d3\"), n = n(), _popScopeId(), n;\n};\nvar _hoisted_1 = /*#__PURE__*/_withScopeId(function () {\n  return /*#__PURE__*/_createElementVNode(\"div\", {\n    \"class\": \"mb-3\"\n  }, [/*#__PURE__*/_createElementVNode(\"legend\", null, \"旗站資料\")], -1 /* HOISTED */);\n});\nvar _hoisted_2 = /*#__PURE__*/_withScopeId(function () {\n  return /*#__PURE__*/_createElementVNode(\"div\", {\n    \"class\": \"mb-3\"\n  }, [/*#__PURE__*/_createElementVNode(\"label\", {\n    \"for\": \"name\",\n    \"class\": \"form-label\"\n  }, \"旗站名稱\"), /*#__PURE__*/_createElementVNode(\"input\", {\n    type: \"text\",\n    \"class\": \"form-control\",\n    required: \"required\"\n  })], -1 /* HOISTED */);\n});\nvar _hoisted_3 = {\n  \"class\": \"mb-3\"\n};\nvar _hoisted_4 = /*#__PURE__*/_withScopeId(function () {\n  return /*#__PURE__*/_createElementVNode(\"label\", {\n    \"for\": \"district\",\n    \"class\": \"form-label\"\n  }, \"地區\", -1 /* HOISTED */);\n});\nvar _hoisted_5 = /*#__PURE__*/_withScopeId(function () {\n  return /*#__PURE__*/_createElementVNode(\"option\", {\n    disabled: \"\",\n    value: \"\"\n  }, \"請選擇\", -1 /* HOISTED */);\n});\nvar _hoisted_6 = [\"value\"];\nvar _hoisted_7 = {\n  \"class\": \"mb-3\"\n};\nvar _hoisted_8 = /*#__PURE__*/_withScopeId(function () {\n  return /*#__PURE__*/_createElementVNode(\"label\", {\n    \"for\": \"address\",\n    \"class\": \"form-label\"\n  }, \"地址\", -1 /* HOISTED */);\n});\nvar _hoisted_9 = {\n  \"class\": \"mb-3\"\n};\nvar _hoisted_10 = /*#__PURE__*/_withScopeId(function () {\n  return /*#__PURE__*/_createElementVNode(\"label\", {\n    \"for\": \"subdistrict\",\n    \"class\": \"form-label\"\n  }, \"所屬旗站\", -1 /* HOISTED */);\n});\nvar _hoisted_11 = {\n  \"class\": \"mb-3\"\n};\nvar _hoisted_12 = /*#__PURE__*/_withScopeId(function () {\n  return /*#__PURE__*/_createElementVNode(\"label\", {\n    \"for\": \"flagbag\",\n    \"class\": \"form-label\"\n  }, \"已發送旗袋\", -1 /* HOISTED */);\n});\nvar _hoisted_13 = /*#__PURE__*/_withScopeId(function () {\n  return /*#__PURE__*/_createElementVNode(\"div\", {\n    \"class\": \"mb-3\"\n  }, [/*#__PURE__*/_createElementVNode(\"legend\", null, \"旗站負責人\")], -1 /* HOISTED */);\n});\nvar _hoisted_14 = {\n  \"class\": \"mb-3\"\n};\nvar _hoisted_15 = /*#__PURE__*/_withScopeId(function () {\n  return /*#__PURE__*/_createElementVNode(\"label\", {\n    \"for\": \"ic\",\n    \"class\": \"form-label\"\n  }, \"站長\", -1 /* HOISTED */);\n});\nvar _hoisted_16 = /*#__PURE__*/_withScopeId(function () {\n  return /*#__PURE__*/_createElementVNode(\"option\", {\n    disabled: \"\",\n    value: \"\"\n  }, \"Please select one\", -1 /* HOISTED */);\n});\nvar _hoisted_17 = [\"value\"];\nvar _hoisted_18 = {\n  \"class\": \"mb-3 =d-flex\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"form\", null, [_hoisted_1, _hoisted_2, _createElementVNode(\"div\", _hoisted_3, [_hoisted_4, _withDirectives(_createElementVNode(\"select\", {\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = function ($event) {\n      return $setup.item = $event;\n    }),\n    \"class\": \"form-select\",\n    \"aria-label\": \"Default select example\"\n  }, [_hoisted_5, (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.districts, function (district) {\n    return _openBlock(), _createElementBlock(\"option\", {\n      key: district,\n      value: district\n    }, _toDisplayString(district.name), 9 /* TEXT, PROPS */, _hoisted_6);\n  }), 128 /* KEYED_FRAGMENT */))], 512 /* NEED_PATCH */), [[_vModelSelect, $setup.item]])]), _createElementVNode(\"div\", _hoisted_7, [_hoisted_8, _withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = function ($event) {\n      return $setup.item = $event;\n    }),\n    type: \"text\",\n    \"class\": \"form-control\",\n    required: \"required\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.item]])]), _createElementVNode(\"div\", _hoisted_9, [_hoisted_10, _withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = function ($event) {\n      return $setup.item = $event;\n    }),\n    type: \"text\",\n    \"class\": \"form-control\",\n    required: \"required\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.item]])]), _createElementVNode(\"div\", _hoisted_11, [_hoisted_12, _withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[3] || (_cache[3] = function ($event) {\n      return $setup.item = $event;\n    }),\n    type: \"number\",\n    \"class\": \"form-control\",\n    required: \"required\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.item]])]), _hoisted_13, _createElementVNode(\"div\", _hoisted_14, [_hoisted_15, _withDirectives(_createElementVNode(\"select\", {\n    \"onUpdate:modelValue\": _cache[4] || (_cache[4] = function ($event) {\n      return $setup.item = $event;\n    }),\n    \"class\": \"form-select\",\n    \"aria-label\": \"Default select example\"\n  }, [_hoisted_16, (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.ics, function (ic) {\n    return _openBlock(), _createElementBlock(\"option\", {\n      key: ic,\n      value: ic.ic\n    }, _toDisplayString(ic.username), 9 /* TEXT, PROPS */, _hoisted_17);\n  }), 128 /* KEYED_FRAGMENT */))], 512 /* NEED_PATCH */), [[_vModelSelect, $setup.item]])]), _createElementVNode(\"div\", _hoisted_18, [_createElementVNode(\"button\", {\n    type: \"submit\",\n    \"class\": \"btn btn-primary\",\n    onClick: _cache[5] || (_cache[5] = function () {\n      return $setup.submit && $setup.submit.apply($setup, arguments);\n    })\n  }, \" 儲存 \"), _createElementVNode(\"button\", {\n    id: \"Dbutton\",\n    \"class\": \"btn btn-danger\",\n    onClick: _cache[6] || (_cache[6] = function () {\n      return $setup.deleteItem && $setup.deleteItem.apply($setup, arguments);\n    })\n  }, \" 刪除 \")])]);\n}","map":{"version":3,"names":["_createElementVNode","type","required","disabled","value","_createElementBlock","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","$setup","item","$event","_hoisted_5","_Fragment","_renderList","districts","district","key","name","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","ics","ic","username","_hoisted_17","_hoisted_18","onClick","_cache","submit","apply","arguments","id","deleteItem"],"sources":["/Users/paksumtung/Documents/COMP4117/comp4117-spring2023-frontend-group-d/src/components/StationsForm.vue"],"sourcesContent":["\n<template>\n  <form>\n    <div class=\"mb-3\">\n      <legend>旗站資料</legend>\n    </div>\n    <div class=\"mb-3\">\n      <label for=\"name\" class=\"form-label\">旗站名稱</label>\n      <input\n        v-model=\"item.\"\n        type=\"text\"\n        class=\"form-control\"\n        required=\"required\"\n      />\n    </div>\n    <div class=\"mb-3\">\n      <label for=\"district\" class=\"form-label\">地區</label>\n      <select\n        v-model=\"item\"\n        class=\"form-select\"\n        aria-label=\"Default select example\"\n      >\n        <option disabled value=\"\">請選擇</option>\n        <option v-for=\"district in districts\" :key=\"district\" :value=\"district\">\n          {{ district.name }}\n        </option>\n      </select>\n    </div>\n    <div class=\"mb-3\">\n      <label for=\"address\" class=\"form-label\">地址</label>\n      <input\n        v-model=\"item\"\n        type=\"text\"\n        class=\"form-control\"\n        required=\"required\"\n      />\n    </div>\n    <div class=\"mb-3\">\n      <label for=\"subdistrict\" class=\"form-label\">所屬旗站</label>\n      <input\n        v-model=\"item\"\n        type=\"text\"\n        class=\"form-control\"\n        required=\"required\"\n      />\n    </div>\n    <div class=\"mb-3\">\n      <label for=\"flagbag\" class=\"form-label\">已發送旗袋</label>\n      <input\n        v-model=\"item\"\n        type=\"number\"\n        class=\"form-control\"\n        required=\"required\"\n      />\n    </div>\n\n    <div class=\"mb-3\">\n      <legend>旗站負責人</legend>\n    </div>\n    <div class=\"mb-3\">\n      <label for=\"ic\" class=\"form-label\">站長</label>\n      <select\n        v-model=\"item\"\n        class=\"form-select\"\n        aria-label=\"Default select example\"\n      >\n        <option disabled value=\"\">Please select one</option>\n        <option v-for=\"ic in ics\" :key=\"ic\" :value=\"ic.ic\">\n          {{ ic.username }}\n        </option>\n      </select>\n    </div>\n\n    <div class=\"mb-3 =d-flex\">\n      <button type=\"submit\" class=\"btn btn-primary\" @click=\"submit\">\n        儲存\n      </button>\n      <button id=\"Dbutton\" class=\"btn btn-danger\" @click=\"deleteItem\">\n        刪除\n      </button>\n    </div>\n  </form>\n</template>\n\n<script>\nimport { onMounted, computed, ref } from \"vue\";\nimport { useRoute } from \"vue-router\";\n\nexport default {\n  name: \"StationsForm\",\n  setup() {\n    const item = ref({});\n    let updateForm = ref(false);\n    let selected = ref(\"\");\n    let path = ref();\n    const eid = ref();\n    const router = useRoute();\n    const ics = ref({});\n    const districts = computed(() => {\n      return [\n        {\n          district: \"Islands\",\n          name: \"離島區\",\n        },\n        {\n          district: \"KwaiTsing\",\n          name: \"葵青區\",\n        },\n        {\n          district: \"North\",\n          name: \"北區\",\n        },\n        {\n          district: \"SaiKung\",\n          name: \"西貢區\",\n        },\n        {\n          district: \"ShaTin\",\n          name: \"沙田區\",\n        },\n        {\n          district: \"TaiPo\",\n          name: \"大埔區\",\n        },\n        {\n          district: \"TsuenWan\",\n          name: \"荃灣區\",\n        },\n        {\n          district: \"TuenMun\",\n          name: \"屯門區\",\n        },\n        {\n          district: \"YuenLong\",\n          name: \"元朗區\",\n        },\n        {\n          district: \"KowloonCity\",\n          name: \"九龍城區\",\n        },\n        {\n          district: \"KwunTong\",\n          name: \"觀塘區\",\n        },\n        {\n          district: \"ShamShuiPo\",\n          name: \"深水埗區\",\n        },\n        {\n          district: \"WongTaiSin\",\n          name: \"黃大仙區\",\n        },\n        {\n          district: \"CentralandWestern\",\n          name: \"中西區\",\n        },\n        {\n          district: \"Eastern\",\n          name: \"東區\",\n        },\n        {\n          district: \"Southern\",\n          name: \"南區\",\n        },\n        {\n          district: \"WanChai\",\n          name: \"灣仔區\",\n        },\n      ];\n    });\n\n    onMounted(() => {\n      if (!(router.params.sid == null)) {\n        updateForm.value = true;\n        fetchPage();\n        console.log(\"here\")\n        //fetchICs();\n      } else {\n        document.getElementById(\"Dbutton\").style.display = \"none\";\n      }\n      getEid();\n      getPath();\n    });\n\n    const fetchPage = async function () \n    {\n      const response = await fetch(`/api/stations/get/${router.params.sid}`);\n      console.log(\"fetchPage\")\n      if (response.ok) {\n        let data = await response.json();\n        item.value = data.items;\n        selected.value = item.value.district;\n      }\n    };\n\n    const getEid = function () \n    {\n      eid.value = router.params.eid;\n    };\n\n    const verifyNull = function () \n    {\n      //console.log(item.name);\n      if (\n        !item.value.name ||\n        !item.value.district ||\n        !item.value.address ||\n        !item.value.subdistrict ||\n        !item.value.flagbag\n      ) {\n        return false;\n      }\n    };\n\n    // eslint-disable-next-line no-unused-vars\n    const getPath = function () \n    {\n      let elements = router.path.split(\"/\");\n      path.value = \"/\" + elements[1];\n      for (let i = 2; i < elements.length - 1; i++) {\n        path.value += \"/\" + elements[i];\n      }\n    };\n\n      const submit = async function (event) \n      {\n        event.preventDefault();\n        if (!updateForm.value) {\n          item.value.eid = eid.value;\n          if (!verifyNull()) {\n            alert(\"please fill in all information\");\n          } else {\n            const response = await fetch(`/api/stations/create`, {\n              method: \"post\",\n              headers: {\n                \"Content-Type\": \"application/json\",\n              },\n              body: JSON.stringify(item.value),\n            });\n            if (response.ok) {\n              alert(\"建立成功\");\n              //getEid();\n              window.location.replace(path.value);\n            } else {\n              alert(response.statusText);\n            }\n          }\n        } else {\n          if (!verifyNull()) {\n            alert(\"please fill in all information\");\n          } else {\n            const id = item.value._id;\n            delete item.value._id;\n            const response = await fetch(`/api/stations/update/${id}`, {\n              method: \"put\",\n              headers: {\n                \"Content-Type\": \"application/json\",\n              },\n              body: JSON.stringify(item.value),\n            });\n\n            if (response.ok) {\n              alert(\"編輯成功\");\n              //getEid();\n              window.location.replace(path.value);\n            } else {\n              alert(response.statusText);\n            }\n          }\n        }\n      };\n\n      const deleteItem = async function (event) \n      {\n        event.preventDefault();\n        let id = item.value._id;\n        if (confirm(\"確定刪除?\")) {\n          const response = await fetch(`/api/stations/delete/${id}`, {\n            method: \"delete\",\n            body: JSON.stringify(item.value),\n          });\n          console.log(\"line 158\");\n          if (response.ok) {\n            alert(\"項目已刪除\");\n            location.assign(path.value);\n          } else {\n            alert(response.statusText);\n          }\n        }\n      };\n\n      const fetchICs = async function () \n      {\n        const response = await fetch(\"/api/stations/usersss\");\n        let data = await response.json();\n        ics.value = data.users;\n        console.log(data.users);\n      };\n\n      return {\n        districts,\n        updateForm,\n        selected,\n        submit,\n        deleteItem,\n        verifyNull,\n        fetchICs,\n        ics,\n        item\n        \n      };\n    },\n  };\n\n</script>\n<style scoped>\n.btn {\n  margin-right: 10px;\n}\n</style>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}