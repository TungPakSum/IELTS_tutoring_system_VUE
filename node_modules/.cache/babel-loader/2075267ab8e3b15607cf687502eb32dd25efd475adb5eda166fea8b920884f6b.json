{"ast":null,"code":"import \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.slice.js\";\nimport { vModelText as _vModelText, createElementVNode as _createElementVNode, withDirectives as _withDirectives, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, toDisplayString as _toDisplayString, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nimport _imports_0 from '../assets/userIcon.png';\nvar _withScopeId = function _withScopeId(n) {\n  return _pushScopeId(\"data-v-6ff3d538\"), n = n(), _popScopeId(), n;\n};\nvar _hoisted_1 = {\n  \"class\": \"row\"\n};\nvar _hoisted_2 = {\n  \"class\": \"col-12 p-3 searchBox\"\n};\nvar _hoisted_3 = {\n  \"class\": \"row card-group\"\n};\nvar _hoisted_4 = /*#__PURE__*/_withScopeId(function () {\n  return /*#__PURE__*/_createElementVNode(\"div\", {\n    \"class\": \"card-up aqua-gradient\"\n  }, null, -1 /* HOISTED */);\n});\nvar _hoisted_5 = {\n  \"class\": \"avatar mx-auto white\"\n};\nvar _hoisted_6 = [\"onClick\"];\nvar _hoisted_7 = {\n  \"class\": \"card-body text-center\"\n};\nvar _hoisted_8 = {\n  \"class\": \"card-title font-weight-bold\"\n};\nvar _hoisted_9 = /*#__PURE__*/_withScopeId(function () {\n  return /*#__PURE__*/_createElementVNode(\"hr\", null, null, -1 /* HOISTED */);\n});\nvar _hoisted_10 = {\n  key: 0\n};\nvar _hoisted_11 = {\n  key: 1\n};\nvar _hoisted_12 = {\n  \"class\": \"pagination-group row\"\n};\nvar _hoisted_13 = {\n  \"aria-label\": \"Page navigation example\"\n};\nvar _hoisted_14 = {\n  \"class\": \"pagination\"\n};\nvar _hoisted_15 = /*#__PURE__*/_withScopeId(function () {\n  return /*#__PURE__*/_createElementVNode(\"li\", {\n    \"class\": \"page-item\"\n  }, [/*#__PURE__*/_createElementVNode(\"a\", {\n    \"class\": \"page-link\",\n    href: \"#\",\n    \"aria-label\": \"Previous\"\n  }, [/*#__PURE__*/_createElementVNode(\"span\", {\n    \"aria-hidden\": \"true\"\n  }, \"«\")])], -1 /* HOISTED */);\n});\nvar _hoisted_16 = [\"onClick\"];\nvar _hoisted_17 = /*#__PURE__*/_withScopeId(function () {\n  return /*#__PURE__*/_createElementVNode(\"a\", {\n    \"class\": \"page-link\",\n    \"aria-label\": \"Next\"\n  }, [/*#__PURE__*/_createElementVNode(\"span\", {\n    \"aria-hidden\": \"false\"\n  }, \"»\")], -1 /* HOISTED */);\n});\nvar _hoisted_18 = [_hoisted_17];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  var _component_router_link = _resolveComponent(\"router-link\");\n  return _openBlock(), _createElementBlock(_Fragment, null, [_createElementVNode(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_withDirectives(_createElementVNode(\"input\", {\n    id: \"form1\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = function ($event) {\n      return _ctx.Search = $event;\n    }),\n    type: \"search\",\n    \"class\": \"form-control\",\n    placeholder: \"Search\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, _ctx.Search]])])]), _createCommentVNode(\" <div class=\\\"card-group row\\\"> \"), _createCommentVNode(\" <div\\n      v-for=\\\"item in items\\\"\\n      :key=\\\"item\\\"\\n      class=\\\"col-sm-4\\\"\\n    > \"), _createCommentVNode(\" <div class=\\\"card\\\"> \"), _createCommentVNode(\" <div class=\\\"card-body\\\"> \"), _createCommentVNode(\" <h5 class=\\\"card-title\\\">\\n            {{ item.username }}\\n          </h5>\\n          <p class=\\\"card-text\\\">\\n            {{ item.role }}\\n          </p> \"), _createCommentVNode(\" <p\\n            v-if=\\\"item.role==='admin'\\\"\\n            class=\\\"card-text\\\"\\n          >\\n            {{ item.role }}\\n          </p> \"), _createCommentVNode(\" <router-link\\n            v-slot=\\\"{ navigate }\\\"\\n            :to=\\\"`/${item.role}/${item._id}`\\\"\\n            custom\\n          > \"), _createCommentVNode(\" <a\\n              href=\\\"#\\\"\\n              class=\\\"btn btn-primary\\\"\\n              @click=\\\"navigate\\\"\\n            >編緝</a>\\n          </router-link> \"), _createCommentVNode(\"           <a href=\\\"#\\\" class=\\\"btn btn-danger\\\" @click=\\\"deleteUsers(item._id)\\\"\\n            >刪除</a\\n          > \"), _createCommentVNode(\" </div> \"), _createCommentVNode(\" </div> \"), _createCommentVNode(\" </div> \"), _createCommentVNode(\" </div> \"), _createElementVNode(\"div\", _hoisted_3, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.resultItems, function (item) {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: item,\n      \"class\": \"card testimonial-card col-sm-5\",\n      style: {\n        \"padding\": \"0px\"\n      }\n    }, [_hoisted_4, _createElementVNode(\"div\", _hoisted_5, [_createVNode(_component_router_link, {\n      to: \"/\".concat(item.role, \"/\").concat(item._id),\n      custom: \"\"\n    }, {\n      \"default\": _withCtx(function (_ref) {\n        var navigate = _ref.navigate;\n        return [_createElementVNode(\"img\", {\n          src: _imports_0,\n          \"class\": \"rounded-circle img-fluid\",\n          alt: \"woman avatar\",\n          onClick: navigate\n        }, null, 8 /* PROPS */, _hoisted_6)];\n      }),\n      _: 2 /* DYNAMIC */\n    }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"to\"])]), _createElementVNode(\"div\", _hoisted_7, [_createElementVNode(\"h4\", _hoisted_8, _toDisplayString(item.username), 1 /* TEXT */), _hoisted_9, item.role === 'admin' ? (_openBlock(), _createElementBlock(\"p\", _hoisted_10, \" 管理員 \")) : _createCommentVNode(\"v-if\", true), item.role === 'stationManager' ? (_openBlock(), _createElementBlock(\"p\", _hoisted_11, \" 旗長 \")) : _createCommentVNode(\"v-if\", true)])]);\n  }), 128 /* KEYED_FRAGMENT */))]), _createElementVNode(\"div\", _hoisted_12, [_createElementVNode(\"nav\", _hoisted_13, [_createElementVNode(\"ul\", _hoisted_14, [_hoisted_15, (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.pages.slice(_ctx.currentFirstPage, _ctx.currentLastPage), function (i) {\n    return _openBlock(), _createElementBlock(\"li\", {\n      key: i,\n      \"class\": \"page-item\"\n    }, [_createElementVNode(\"a\", {\n      \"class\": \"page-link\",\n      onClick: function onClick($event) {\n        return _ctx.fetchPage(i);\n      }\n    }, _toDisplayString(i), 9 /* TEXT, PROPS */, _hoisted_16)]);\n  }), 128 /* KEYED_FRAGMENT */)), _createElementVNode(\"li\", {\n    \"class\": \"page-item\",\n    onClick: _cache[1] || (_cache[1] = function ($event) {\n      return _ctx.nextPage(_ctx.i);\n    })\n  }, _hoisted_18)])])])], 64 /* STABLE_FRAGMENT */);\n}","map":{"version":3,"names":["_imports_0","_createElementVNode","href","_hoisted_17","_hoisted_1","_hoisted_2","id","_ctx","Search","$event","type","placeholder","_createCommentVNode","_hoisted_3","_createElementBlock","_Fragment","_renderList","resultItems","item","key","style","_hoisted_4","_hoisted_5","_createVNode","_component_router_link","to","concat","role","_id","custom","_ref","navigate","src","alt","onClick","_hoisted_7","_hoisted_8","_toDisplayString","username","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","pages","slice","currentFirstPage","currentLastPage","i","fetchPage","_hoisted_16","_cache","nextPage"],"sources":["/Users/paksumtung/Documents/COMP4117/comp4117-spring2023-frontend-group-d/src/components/UsersCard.vue"],"sourcesContent":["<template>\n  <div class=\"row\">\n    <div class=\"col-12 p-3 searchBox\">\n      <input id=\"form1\" v-model=\"Search\" type=\"search\" class=\"form-control\" placeholder=\"Search\">\n    </div>\n  </div>\n  <!-- <div class=\"card-group row\"> -->\n  <!-- <div\n      v-for=\"item in items\"\n      :key=\"item\"\n      class=\"col-sm-4\"\n    > -->\n  <!-- <div class=\"card\"> -->\n  <!-- <div class=\"card-body\"> -->\n  <!-- <h5 class=\"card-title\">\n            {{ item.username }}\n          </h5>\n          <p class=\"card-text\">\n            {{ item.role }}\n          </p> -->\n  <!-- <p\n            v-if=\"item.role==='admin'\"\n            class=\"card-text\"\n          >\n            {{ item.role }}\n          </p> -->\n  <!-- <router-link\n            v-slot=\"{ navigate }\"\n            :to=\"`/${item.role}/${item._id}`\"\n            custom\n          > -->\n  <!-- <a\n              href=\"#\"\n              class=\"btn btn-primary\"\n              @click=\"navigate\"\n            >編緝</a>\n          </router-link> -->\n  <!--           <a href=\"#\" class=\"btn btn-danger\" @click=\"deleteUsers(item._id)\"\n            >刪除</a\n          > -->\n  <!-- </div> -->\n  <!-- </div> -->\n  <!-- </div> -->\n  <!-- </div> -->\n  <div class=\"row card-group\">\n    <div v-for=\"item in resultItems\" :key=\"item\" class=\"card testimonial-card col-sm-5\" style=\"padding: 0px\">\n      <div class=\"card-up aqua-gradient\" />\n      <div class=\"avatar mx-auto white\">\n        <router-link v-slot=\"{ navigate }\" :to=\"`/${item.role}/${item._id}`\" custom>\n          <img src=\"../assets/userIcon.png\" class=\"rounded-circle img-fluid\" alt=\"woman avatar\" @click=\"navigate\">\n        </router-link>\n      </div>\n      <div class=\"card-body text-center\">\n        <h4 class=\"card-title font-weight-bold\">\n          {{ item.username }}\n        </h4>\n        <hr>\n        <p v-if=\"item.role === 'admin'\">\n          管理員\n        </p>\n        <p v-if=\"item.role === 'stationManager'\">\n          旗長\n        </p>\n      </div>\n    </div>\n  </div>\n\n  <div class=\"pagination-group row\">\n    <nav aria-label=\"Page navigation example\">\n      <ul class=\"pagination\">\n        <li class=\"page-item\">\n          <a class=\"page-link\" href=\"#\" aria-label=\"Previous\">\n            <span aria-hidden=\"true\">&laquo;</span>\n          </a>\n        </li>\n        <li v-for=\"i in pages.slice(currentFirstPage, currentLastPage)\" :key=\"i\" class=\"page-item\">\n          <a class=\"page-link\" @click=\"fetchPage(i)\">{{ i }}</a>\n        </li>\n        <li class=\"page-item\" @click=\"nextPage(i)\">\n          <a class=\"page-link\" aria-label=\"Next\">\n            <span aria-hidden=\"false\">&raquo;</span>\n          </a>\n        </li>\n      </ul>\n    </nav>\n  </div>\n</template>\n\n<script>\nimport { ref, onMounted, computed } from \"vue\";\nimport { useRoute } from \"vue-router\";\n\nexport default {\n  setup: function () {\n    const lastPage = ref(0);\n    const perPage = ref(6);\n    const router = useRoute()\n    let currentFirstPage = ref(1);\n    let currentLastPage = ref(3);\n    let currentPage = ref();\n    let items = ref([]);\n    let Search = ref();\n\n    onMounted(function () {\n      fetchPage(1);\n      currentFirstPage.value = 0;\n      currentLastPage.value = 3;\n    });\n\n    const resultItems = computed(() => {\n      if (Search.value) {\n        return items.value.filter((item) => {\n          console.log(item)\n          return item.username.toLowerCase().indexOf(Search.value.toLowerCase()) !== -1\n            || item.role.toLowerCase().indexOf(Search.value.toLowerCase()) !== -1\n          // || item.email.toLowerCase().indexOf(Search.value.toLowerCase()) !== -1\n        })\n      }\n      return items.value;\n    })\n\n    const pages = computed(() => {\n      let pages = [];\n      for (let i = 1; i <= lastPage.value; i++) {\n        pages.push(i);\n      }\n      return pages;\n    });\n\n    const fetchPage = async function (page) {\n      let userType = router.path.split('/')[1];\n      const response = await fetch(\n        `/api/users/get/role/${userType}?perPage=${perPage.value}&page=${page}`,\n        {\n          headers: {\n            \"x-access-token\": localStorage.getItem(\"token\")\n          }\n        }\n      );\n      currentPage.value = page;\n      if (response.ok) {\n        let data = await response.json();\n        items.value = data.items;\n        lastPage.value = data.pages;\n      } else {\n        if (response.status === 401) {\n          alert(response.statusText);\n          location.assign(\"/login\");\n        } else if (response.status === 403) {\n          alert(response.statusText);\n          history.back()\n        } else\n          alert(response.send);\n      }\n    };\n\n    const createUsers = async function (id) {\n      const response = await fetch(`/api/users/create/${id}`, {\n        method: \"post\",\n        body: JSON.stringify(items.value),\n      });\n      if (response.ok) {\n        alert(\"Users created!\");\n        location.assign(\"/users\");\n      } else {\n        alert(response.statusText);\n      }\n    };\n\n    const deleteUsers = async function (id) {\n      const response = await fetch(`/api/users/delete/${id}`, {\n        method: \"delete\",\n        body: JSON.stringify(items.value),\n      });\n      if (response.ok) {\n        alert(\"Users deleted\");\n        location.assign(\"/users\");\n      } else {\n        alert(response.statusText);\n      }\n    };\n\n    // eslint-disable-next-line no-unused-vars\n    const pagination = async function (page) { };\n\n    const nextPage = (currentPage) => {\n      fetchPage(currentPage);\n      currentFirstPage.value += 3;\n      currentLastPage.value += 3;\n    };\n\n    //     const filterItems = async function (searchText) {\n    //       if (searchText) {\n\n    //         const searchTokens = searchText.toLowerCase().split(\" \");\n\n    //         // const searchTextLower = searchText.replaceAll(\" \", \"\").toLowerCase();\n    //         // alert(searchTextLower) \n    //         const filteredItems = itemsWithoutPages.value.filter((item) => {\n    //           for(let t in searchTokens) {\n    //             if(item.username.toLowerCase().indexOf(searchTokens[t]) !== -1\n    //               || item.email.toLowerCase().indexOf(searchTokens[t]) !== -1\n    //               || item.role.toLowerCase().indexOf(searchTokens[t]) !== -1) {\n    //               return true\n    //             }\n    //           }\n    //           return false\n\n\n    //         // return true\n    // //           return (\n    // // /*             item[\"name\"]\n    // //               .replaceAll(\" \", \"\")\n    // //               .toLowerCase()\n    // //               .includes(searchTextLower) || */\n    // //             item.username\n    // //               .replaceAll(\" \", \"\")\n    // //               .toLowerCase()\n    // //               .includes(searchTextLower)\n    // //           );\n    //         });\n    //         // alert(JSON.stringify(items.value))\n    //         items.value = filteredItems;\n    //         lastPage.value = items.value.length / perPage.value;\n    //       } else if (searchText === \"\") {\n    //         console.log(currentPage);\n    //         await fetchPage(currentPage.value);\n    //       }\n    //     };\n\n    const test = function (page) {\n      fetchPage(page);\n      console.log(page);\n    };\n\n    return {\n      items,\n      Search,\n      pages,\n      currentFirstPage,\n      currentLastPage,\n      fetchPage,\n      nextPage,\n      pagination,\n      test,\n      deleteUsers,\n      createUsers,\n      //filterItems,\n      currentPage,\n      resultItems\n    };\n  },\n};\n</script>\n\n<style scoped>\n.pagination-group {\n  margin-top: 20px;\n}\n\n.card {\n  /* <<<<<<< HEAD */\n  margin: 10px;\n}\n\nbody {\n  background-color: #f5f7fa;\n}\n\n.testimonial-card .card-up {\n  height: 120px;\n  overflow: hidden;\n  border-top-left-radius: 0.25rem;\n  border-top-right-radius: 0.25rem;\n}\n\n.aqua-gradient {\n  background: linear-gradient(40deg, #2096ff, #05ffa3) !important;\n}\n\n.testimonial-card .avatar {\n  width: 120px;\n  margin-top: -60px;\n  overflow: hidden;\n  border: 5px solid #fff;\n  border-radius: 50%;\n  /* ======= */\n  margin-bottom: 10px;\n  /* >>>>>>> fa756739e5a8d40c680b0bed8f025463ddd8a7db */\n}\n</style>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}