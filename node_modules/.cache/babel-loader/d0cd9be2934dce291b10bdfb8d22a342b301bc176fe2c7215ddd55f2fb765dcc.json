{"ast":null,"code":"import _regeneratorRuntime from \"/Users/paksumtung/Documents/COMP4117/comp4117-spring2023-frontend-group-d/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/paksumtung/Documents/COMP4117/comp4117-spring2023-frontend-group-d/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.number.constructor.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.object.define-property.js\";\nimport { onMounted } from 'vue';\nimport { Html5QrcodeScanner } from \"html5-qrcode\";\nimport soundFile from '@/assets/alarm.mp3';\nexport default {\n  __name: 'QrCodeScanner',\n  props: {\n    qrbox: {\n      type: Number,\n      \"default\": 250\n    },\n    fps: {\n      type: Number,\n      \"default\": 10\n    }\n  },\n  setup: function setup(__props, _ref) {\n    var expose = _ref.expose;\n    expose();\n    var props = __props;\n    var audio = new window.Audio();\n    audio.src = soundFile;\n    //const emit = defineEmits(['result']);\n\n    var onScanSuccess = /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(decodedText) {\n        var id, response;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              audio.play();\n              if (!window.confirm('FlagBag ID: ' + decodedText + 'Its status is')) {\n                _context.next = 10;\n                break;\n              }\n              // Perform the action when the user clicks \"OK\"\n              console.log('Confirmed');\n              //console.log(\"decodedText:\"+ decodedText);\n              //console.log(\"decodedResult:\"+ decodedResult);\n              id = decodedText;\n              _context.next = 6;\n              return fetch(\"/api/flagbags/updateQr/\".concat(id), {\n                method: 'put'\n              });\n            case 6:\n              response = _context.sent;\n              if (response.ok) {\n                alert(\"旗袋已收回\");\n              }\n              _context.next = 11;\n              break;\n            case 10:\n              // Perform the action when the user clicks \"Cancel\"\n              console.log('Cancelled');\n            case 11:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee);\n      }));\n      return function onScanSuccess(_x) {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n    onMounted(function () {\n      var html5QrcodeScanner = new Html5QrcodeScanner('qr-code-full-region', props);\n      html5QrcodeScanner.render(onScanSuccess);\n    });\n    var __returned__ = {\n      props: props,\n      audio: audio,\n      onScanSuccess: onScanSuccess,\n      onMounted: onMounted,\n      get Html5QrcodeScanner() {\n        return Html5QrcodeScanner;\n      },\n      get soundFile() {\n        return soundFile;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["onMounted","Html5QrcodeScanner","soundFile","audio","window","Audio","src","onScanSuccess","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","decodedText","id","response","wrap","_callee$","_context","prev","next","play","confirm","console","log","fetch","concat","method","sent","ok","alert","stop","_x","apply","arguments","html5QrcodeScanner","props","render"],"sources":["/Users/paksumtung/Documents/COMP4117/comp4117-spring2023-frontend-group-d/src/components/QrCodeScanner.vue"],"sourcesContent":["<script setup>\nimport {  defineProps, onMounted} from 'vue'\nimport { Html5QrcodeScanner } from \"html5-qrcode\"\nimport soundFile from '@/assets/alarm.mp3';\n\nconst props = defineProps({\n  qrbox: {\n    type: Number,\n    default: 250\n  },\n  fps: {\n    type: Number,\n    default: 10\n  }, \n});\n\nconst audio = new window.Audio();\naudio.src = soundFile;\n//const emit = defineEmits(['result']);\n\n\nconst onScanSuccess = async function(decodedText) \n{\n  audio.play();\n  if (window.confirm('FlagBag ID: ' + decodedText + 'Its status is'))\n  {\n        // Perform the action when the user clicks \"OK\"\n        console.log('Confirmed');\n        //console.log(\"decodedText:\"+ decodedText);\n        //console.log(\"decodedResult:\"+ decodedResult);\n        const id = decodedText;\n        const response = await fetch(`/api/flagbags/updateQr/${id}`, {\n        method: 'put',\n        });\n\n        if(response.ok)\n        {\n          alert(\"旗袋已收回\");\n        }\n  } else\n  {\n        // Perform the action when the user clicks \"Cancel\"\n        console.log('Cancelled');\n  }\n  \n  \n}\n\nonMounted(() => {\n  const html5QrcodeScanner = new Html5QrcodeScanner('qr-code-full-region', props);\n  html5QrcodeScanner.render(onScanSuccess);\n});\n</script>\n\n<template>\n<div id=\"qr-code-full-region\"></div>\n</template>\n"],"mappings":";;;;;AACA,SAAuBA,SAAS,QAAO,KAAK;AAC5C,SAASC,kBAAkB,QAAQ,cAAc;AACjD,OAAOC,SAAS,MAAM,oBAAoB;;;;;;;;;;;;;;;;;IAa1C,IAAMC,KAAK,GAAG,IAAIC,MAAM,CAACC,KAAK,EAAE;IAChCF,KAAK,CAACG,GAAG,GAAGJ,SAAS;IACrB;;IAGA,IAAMK,aAAa;MAAA,IAAAC,KAAA,GAAAC,iBAAA,eAAAC,mBAAA,GAAAC,IAAA,CAAG,SAAAC,QAAeC,WAAW;QAAA,IAAAC,EAAA,EAAAC,QAAA;QAAA,OAAAL,mBAAA,GAAAM,IAAA,UAAAC,SAAAC,QAAA;UAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;YAAA;cAE9CjB,KAAK,CAACkB,IAAI,EAAE;cAAC,KACTjB,MAAM,CAACkB,OAAO,CAAC,cAAc,GAAGT,WAAW,GAAG,eAAe,CAAC;gBAAAK,QAAA,CAAAE,IAAA;gBAAA;cAAA;cAE5D;cACAG,OAAO,CAACC,GAAG,CAAC,WAAW,CAAC;cACxB;cACA;cACMV,EAAE,GAAGD,WAAW;cAAAK,QAAA,CAAAE,IAAA;cAAA,OACCK,KAAK,2BAAAC,MAAA,CAA2BZ,EAAE,GAAI;gBAC7Da,MAAM,EAAE;cACR,CAAC,CAAC;YAAA;cAFIZ,QAAQ,GAAAG,QAAA,CAAAU,IAAA;cAId,IAAGb,QAAQ,CAACc,EAAE,EACd;gBACEC,KAAK,CAAC,OAAO,CAAC;cAChB;cAACZ,QAAA,CAAAE,IAAA;cAAA;YAAA;cAGD;cACAG,OAAO,CAACC,GAAG,CAAC,WAAW,CAAC;YAAC;YAAA;cAAA,OAAAN,QAAA,CAAAa,IAAA;UAAA;QAAA,GAAAnB,OAAA;MAAA,CAIhC;MAAA,gBAzBKL,aAAaA,CAAAyB,EAAA;QAAA,OAAAxB,KAAA,CAAAyB,KAAA,OAAAC,SAAA;MAAA;IAAA,GAyBlB;IAEDlC,SAAS,CAAC,YAAM;MACd,IAAMmC,kBAAkB,GAAG,IAAIlC,kBAAkB,CAAC,qBAAqB,EAAEmC,KAAK,CAAC;MAC/ED,kBAAkB,CAACE,MAAM,CAAC9B,aAAa,CAAC;IAC1C,CAAC,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}