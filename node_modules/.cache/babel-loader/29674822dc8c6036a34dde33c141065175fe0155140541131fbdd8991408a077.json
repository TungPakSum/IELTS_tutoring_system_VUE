{"ast":null,"code":"import \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.symbol.description.js\";\nimport { createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, vModelSelect as _vModelSelect, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nvar _withScopeId = function _withScopeId(n) {\n  return _pushScopeId(\"data-v-3187412d\"), n = n(), _popScopeId(), n;\n};\nvar _hoisted_1 = {\n  \"class\": \"row justify-content-center\"\n};\nvar _hoisted_2 = /*#__PURE__*/_withScopeId(function () {\n  return /*#__PURE__*/_createElementVNode(\"div\", {\n    \"class\": \"mb-3\"\n  }, [/*#__PURE__*/_createElementVNode(\"legend\", null, \"建立活動\")], -1 /* HOISTED */);\n});\nvar _hoisted_3 = {\n  \"class\": \"mb-3\"\n};\nvar _hoisted_4 = /*#__PURE__*/_withScopeId(function () {\n  return /*#__PURE__*/_createElementVNode(\"label\", {\n    \"for\": \"eventName\",\n    \"class\": \"form-label\"\n  }, \" 活動名稱\", -1 /* HOISTED */);\n});\nvar _hoisted_5 = {\n  \"class\": \"mb-3\"\n};\nvar _hoisted_6 = /*#__PURE__*/_withScopeId(function () {\n  return /*#__PURE__*/_createElementVNode(\"label\", {\n    \"for\": \"date\",\n    \"class\": \"form-label\"\n  }, \"日期\", -1 /* HOISTED */);\n});\nvar _hoisted_7 = {\n  \"class\": \"mb-3\"\n};\nvar _hoisted_8 = /*#__PURE__*/_withScopeId(function () {\n  return /*#__PURE__*/_createElementVNode(\"label\", {\n    \"for\": \"form-select\",\n    \"class\": \"form-label\"\n  }, \"賣旗地點\", -1 /* HOISTED */);\n});\nvar _hoisted_9 = /*#__PURE__*/_withScopeId(function () {\n  return /*#__PURE__*/_createElementVNode(\"option\", {\n    disabled: \"\",\n    value: \"\"\n  }, \" 請選擇 \", -1 /* HOISTED */);\n});\nvar _hoisted_10 = [\"value\", \"selected\"];\nvar _hoisted_11 = {\n  \"class\": \"mb-3\"\n};\nvar _hoisted_12 = /*#__PURE__*/_withScopeId(function () {\n  return /*#__PURE__*/_createElementVNode(\"label\", {\n    \"for\": \"location\",\n    \"class\": \"form-label\"\n  }, \"旗袋總數\", -1 /* HOISTED */);\n});\nvar _hoisted_13 = {\n  \"class\": \"mb-3\"\n};\nvar _hoisted_14 = {\n  \"class\": \"form-group\"\n};\nvar _hoisted_15 = /*#__PURE__*/_withScopeId(function () {\n  return /*#__PURE__*/_createElementVNode(\"label\", {\n    \"for\": \"exampleFormControlTextarea1\"\n  }, \"活動簡介\", -1 /* HOISTED */);\n});\nvar _hoisted_16 = {\n  \"class\": \"mb-3 =d-flex\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"form\", null, [_hoisted_2, _createElementVNode(\"div\", _hoisted_3, [_hoisted_4, _withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = function ($event) {\n      return $setup.items.name = $event;\n    }),\n    type: \"text\",\n    \"class\": \"form-control\",\n    required: \"required\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.items.name]])]), _createElementVNode(\"div\", _hoisted_5, [_hoisted_6, _withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = function ($event) {\n      return $setup.items.date = $event;\n    }),\n    type: \"date\",\n    \"class\": \"form-control\",\n    required: \"required\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.items.date]])]), _createElementVNode(\"div\", _hoisted_7, [_hoisted_8, _withDirectives(_createElementVNode(\"select\", {\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = function ($event) {\n      return $setup.items.location = $event;\n    }),\n    \"class\": \"form-select\",\n    \"aria-label\": \"Default select example\"\n  }, [_hoisted_9, (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.locations, function (location) {\n    return _openBlock(), _createElementBlock(\"option\", {\n      key: location,\n      value: location,\n      selected: location.name === $setup.selected\n    }, _toDisplayString(location.name), 9 /* TEXT, PROPS */, _hoisted_10);\n  }), 128 /* KEYED_FRAGMENT */))], 512 /* NEED_PATCH */), [[_vModelSelect, $setup.items.location]])]), _createElementVNode(\"div\", _hoisted_11, [_hoisted_12, _withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[3] || (_cache[3] = function ($event) {\n      return $setup.items.numOfBags = $event;\n    }),\n    type: \"number\",\n    \"class\": \"form-control\",\n    required: \"required\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.items.numOfBags]])]), _createElementVNode(\"div\", _hoisted_13, [_createElementVNode(\"div\", _hoisted_14, [_hoisted_15, _withDirectives(_createElementVNode(\"textarea\", {\n    id: \"exampleFormControlTextarea1\",\n    \"onUpdate:modelValue\": _cache[4] || (_cache[4] = function ($event) {\n      return $setup.items.description = $event;\n    }),\n    \"class\": \"form-control\",\n    rows: \"3\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.items.description]])])]), _createElementVNode(\"div\", _hoisted_16, [_createElementVNode(\"button\", {\n    type: \"submit\",\n    \"class\": \"btn btn-success\",\n    onClick: _cache[5] || (_cache[5] = function () {\n      return $setup.submit && $setup.submit.apply($setup, arguments);\n    })\n  }, \" 儲存 \"), _createElementVNode(\"button\", {\n    \"class\": \"btn btn-danger\",\n    onClick: _cache[6] || (_cache[6] = function () {\n      return $setup.deleteItem && $setup.deleteItem.apply($setup, arguments);\n    })\n  }, \" 刪除 \")])])]);\n}","map":{"version":3,"names":["_createElementVNode","disabled","value","_createElementBlock","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","$setup","items","name","$event","type","required","_hoisted_5","_hoisted_6","date","_hoisted_7","_hoisted_8","location","_hoisted_9","_Fragment","_renderList","locations","key","selected","_hoisted_10","_hoisted_11","_hoisted_12","numOfBags","_hoisted_13","_hoisted_14","_hoisted_15","id","description","rows","_hoisted_16","onClick","_cache","submit","apply","arguments","deleteItem"],"sources":["/Users/paksumtung/Documents/COMP4117/comp4117-spring2023-frontend-group-d/src/components/EventsForm.vue"],"sourcesContent":["<template>\n  <div class=\"row justify-content-center\">\n    <form>\n      <div class=\"mb-3\">\n        <legend>建立活動</legend>\n      </div>\n      <div class=\"mb-3\">\n        <label\n          for=\"eventName\"\n          class=\"form-label\"\n        > 活動名稱</label>\n        <input\n          v-model=\"items.name\"\n          type=\"text\"\n          class=\"form-control\"\n          required=\"required\"\n        >\n      </div>\n      <div class=\"mb-3\">\n        <label\n          for=\"date\"\n          class=\"form-label\"\n        >日期</label>\n        <input\n          v-model=\"items.date\"\n          type=\"date\"\n          class=\"form-control\"\n          required=\"required\"\n        >\n      </div>\n      <div class=\"mb-3\">\n        <label\n          for=\"form-select\"\n          class=\"form-label\"\n        >賣旗地點</label>\n        <select\n          v-model=\"items.location\"\n          class=\"form-select\"\n          aria-label=\"Default select example\"\n        >\n          <option\n            disabled\n            value=\"\"\n          >\n            請選擇\n          </option>\n          <option\n            v-for=\"location in locations\"\n            :key=\"location\"\n            :value=\"location\"\n            :selected=\"location.name === selected\"\n          >\n            {{ location.name }}\n          </option>\n        </select>\n      </div>\n      <div class=\"mb-3\">\n        <label\n          for=\"location\"\n          class=\"form-label\"\n        >旗袋總數</label>\n        <input\n          v-model=\"items.numOfBags\"\n          type=\"number\"\n          class=\"form-control\"\n          required=\"required\"\n        >\n      </div>\n      <div class=\"mb-3\">\n        <div class=\"form-group\">\n          <label for=\"exampleFormControlTextarea1\">活動簡介</label>\n          <textarea\n            id=\"exampleFormControlTextarea1\"\n            v-model=\"items.description\"\n            class=\"form-control\"\n            rows=\"3\"\n          />\n        </div>\n      </div>\n      <div class=\"mb-3 =d-flex\">\n        <button\n          type=\"submit\"\n          class=\"btn btn-success\"\n          @click=\"submit\"\n        >\n          儲存\n        </button>\n        <button\n          class=\"btn btn-danger\"\n          @click=\"deleteItem\"\n        >\n          刪除\n        </button>\n      </div>\n    </form>\n  </div>\n</template>\n\n<script>\nimport { computed, onMounted, ref } from \"vue\";\nimport { useRoute } from \"vue-router\";\n\nexport default {\n  name: \"EventsForm\",\n  setup() {\n    const items = ref({});\n    const router = useRoute();\n    let updateForm = ref(false);\n    let selected = ref(\"\");\n    let path = ref();\n    const locations = computed(() => {\n      return [\n        {\n          code: \"All\",\n          name: \"全港\",\n        },\n        {\n          code: \"HK\",\n          name: \"香港\",\n        },\n        {\n          code: \"Kowloon\",\n          name: \"九龍\",\n        },\n        {\n          code: \"NT\",\n          name: \"新界\",\n        },\n      ];\n    });\n\n    onMounted(() => {\n      if (!(router.params.eid == null)) {\n        updateForm.value = true;\n        fetchPage();\n      }\n      getPath();\n    });\n\n    const fetchPage = async function () {\n      const response = await fetch(`/api/events/get/${router.params.eid}`);\n      if (response.ok) {\n        let data = await response.json();\n        items.value = data.items;\n        selected.value = items.value.locationName;\n      }\n    };\n\n    const getPath = function () {\n      let elements = router.path.split(\"/\");\n      path.value = \"/\" + elements[1];\n      for (let i = 2; i < elements.length - 1; i++) {\n        path.value += \"/\" + elements[i];\n      }\n    };\n\n    const submit = async function (event) {\n      if (!updateForm.value) {\n        event.preventDefault();\n        const response = await fetch(`/api/events/create`, {\n          method: \"post\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n          },\n          body: JSON.stringify(items.value),\n        });\n        if (response.ok) {\n          alert(\"建立成功\");\n          window.location.assign(path.value);\n        } else {\n          alert(response.statusText);\n        }\n      } else {\n        event.preventDefault();\n        const id = items.value._id;\n        delete items.value._id;\n        const response = await fetch(`/api/events/update/${id}`, {\n          method: \"put\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n          },\n          body: JSON.stringify(items.value),\n        });\n\n        if (response.ok) {\n          alert(\"編輯成功\");\n          window.location.replace(path.value);\n        } else {\n          alert(response.statusText);\n        }\n      }\n    };\n\n    const deleteItem = async function (event) {\n      event.preventDefault();\n      console.log(items.value._id);\n      if (confirm(\"確定刪除?\")) {\n        const response = await fetch(`/api/events/delete/${items.value._id}`, {\n          method: \"delete\",\n          body: JSON.stringify(items.value),\n        });\n        console.log(\"line 158\");\n        if (response.ok) {\n          alert(\"項目已刪除\");\n          location.assign(path.value);\n        } else {\n          alert(response.statusText);\n        }\n      }\n    };\n    return {\n      items,\n      locations,\n      updateForm,\n      selected,\n      submit,\n      deleteItem,\n    };\n  },\n};\n</script>\n\n<style scoped>\n.btn {\n  margin-right: 10px;\n}\n</style>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}