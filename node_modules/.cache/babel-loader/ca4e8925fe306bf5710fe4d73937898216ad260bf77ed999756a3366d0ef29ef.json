{"ast":null,"code":"import _regeneratorRuntime from \"/Users/paksumtung/Documents/COMP4117/comp4117-spring2023-frontend-group-d/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/paksumtung/Documents/COMP4117/comp4117-spring2023-frontend-group-d/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport { computed, onMounted, ref } from \"vue\";\nexport default {\n  name: \"EventsCard\",\n  setup: function setup() {\n    var lastPage = ref(0);\n    var perPage = ref(6);\n    var items = ref([]);\n    var user = ref({});\n    var currentFirstPage = ref(1);\n    var currentLastPage = ref(3);\n    onMounted(function () {\n      fetchPage(1);\n      currentFirstPage.value = 0;\n      currentLastPage.value = 3;\n    });\n    var pages = computed(function () {\n      var pages = [];\n      for (var i = 1; i <= lastPage.value; i++) {\n        pages.push(i);\n      }\n      return pages;\n    });\n    var fetchPage = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(page) {\n        var token, response, data;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              token = localStorage.getItem(\"token\");\n              _context.next = 3;\n              return fetch(\"/api/events/get?perPage=\".concat(perPage.value, \"&page=\").concat(page), {\n                headers: {\n                  \"x-access-token\": token\n                }\n              });\n            case 3:\n              response = _context.sent;\n              if (!response.ok) {\n                _context.next = 14;\n                break;\n              }\n              console.log(response.status);\n              _context.next = 8;\n              return response.json();\n            case 8:\n              data = _context.sent;\n              user.value = data.user;\n              items.value = data.items;\n              lastPage.value = data.pages;\n              _context.next = 15;\n              break;\n            case 14:\n              if (response.status === 401) {\n                alert(response.statusText);\n                location.assign(\"/login\");\n              } else if (response.status === 403) {\n                alert(response.statusText);\n                history.back();\n              } else alert(response.statusText);\n            case 15:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee);\n      }));\n      return function fetchPage(_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n    var nextPage = function nextPage(currentPage) {\n      fetchPage(currentPage);\n      currentFirstPage.value += 3;\n      currentLastPage.value += 3;\n    };\n    return {\n      items: items,\n      pages: pages,\n      currentFirstPage: currentFirstPage,\n      currentLastPage: currentLastPage,\n      fetchPage: fetchPage,\n      nextPage: nextPage\n    };\n  }\n};","map":{"version":3,"names":["computed","onMounted","ref","name","setup","lastPage","perPage","items","user","currentFirstPage","currentLastPage","fetchPage","value","pages","i","push","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","page","token","response","data","wrap","_callee$","_context","prev","next","localStorage","getItem","fetch","concat","headers","sent","ok","console","log","status","json","alert","statusText","location","assign","history","back","stop","_x","apply","arguments","nextPage","currentPage"],"sources":["/Users/paksumtung/Documents/COMP4117/comp4117-spring2023-frontend-group-d/src/components/EventsCard.vue"],"sourcesContent":["<template>\n  <div class=\"row\">\n    <div\n      v-for=\"item in items\"\n      :key=\"item\"\n      class=\"col-lg-3 col-md-4 col-sm-6 col-xs-12\"\n    >\n      <div class=\"tile\">\n        <div class=\"wrapper\">\n          <div class=\"header\">\n            {{ item.name }}\n          </div>\n          <div class=\"banner-img\">\n            <img\n              src=\"http://via.placeholder.com/640x360\"\n              alt=\"Image 1\"\n            >\n          </div>\n          <!-- <h6 class=\"card-subtitle mb-2 text-muted\"> -->\n          <div class=\"dates\">\n            <strong>DATE: </strong> {{ item.date }}\n          </div>\n          <p class=\"card-text\">\n            {{ item.description }}\n          </p>\n        </div>\n        <br>\n        <!-- <ul class=\"list-group list-group-flush\"> -->\n        <div class=\"stats\">\n          <!-- <li class=\"list-group-item\">賣旗地點: {{ item.location.name }}</li> -->\n          <div><STRONG>賣旗地點: </STRONG> {{ item.location.name }}</div>\n\n          <!-- <li class=\"list-group-item\">旗袋總數: {{ item.numOfBags }}</li> -->\n          <!-- <div><STRONG>旗袋總數: </STRONG> {{ item.numOfBags }}</div> -->\n        </div>\n        <!-- </ul> -->\n        <div class=\"footer\">\n          <router-link\n            v-slot=\"{ navigate }\"\n            :to=\"`/events/${item._id}/stations`\"\n            custom\n          >\n            <a\n              class=\"btn btn-success\"\n              @click=\"navigate\"\n            >旗站</a>\n          </router-link>\n          <router-link\n            v-slot=\"{ navigate }\"\n            :to=\"`/events/${item._id}`\"\n            custom\n          >\n            <a\n              class=\"btn btn-success\"\n              @click=\"navigate\"\n            >編緝</a>\n          </router-link>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <div class=\"pagination-group row\">\n    <nav aria-label=\"Page navigation example\">\n      <ul class=\"pagination\">\n        <li class=\"page-item\">\n          <a\n            class=\"page-link\"\n            href=\"#\"\n            aria-label=\"Previous\"\n          >\n            <span aria-hidden=\"true\">&laquo;</span>\n          </a>\n        </li>\n        <li\n          v-for=\"i in pages.slice(currentFirstPage, currentLastPage)\"\n          :key=\"i\"\n          class=\"page-item\"\n        >\n          <a\n            class=\"page-link\"\n            @click=\"fetchPage(i)\"\n          >{{ i }}</a>\n        </li>\n        <li\n          class=\"page-item\"\n          @click=\"nextPage(i)\"\n        >\n          <a\n            class=\"page-link\"\n            aria-label=\"Next\"\n          >\n            <span aria-hidden=\"false\">&raquo;</span>\n          </a>\n        </li>\n      </ul>\n    </nav>\n  </div>\n</template>\n\n<script>\nimport { computed, onMounted, ref } from \"vue\";\n\nexport default {\n  name: \"EventsCard\",\n  setup: function () {\n    const lastPage = ref(0);\n    const perPage = ref(6);\n    const items = ref([]);\n    const user = ref({});\n    let currentFirstPage = ref(1);\n    let currentLastPage = ref(3);\n\n    onMounted(function () {\n      fetchPage(1);\n      currentFirstPage.value = 0;\n      currentLastPage.value = 3;\n    });\n\n    const pages = computed(() => {\n      let pages = [];\n      for (let i = 1; i <= lastPage.value; i++) {\n        pages.push(i);\n      }\n      return pages;\n    });\n\n    const fetchPage = async function (page) {\n      let token = localStorage.getItem(\"token\");\n      const response = await fetch(\n        `/api/events/get?perPage=${perPage.value}&page=${page}`,\n        {\n          headers: {\n            \"x-access-token\": token,\n          },\n        }\n      );\n      if (response.ok) {\n        console.log(response.status);\n        let data = await response.json();\n        user.value = data.user;\n        items.value = data.items;\n        lastPage.value = data.pages;\n      } else {\n        if (response.status === 401) {\n          alert(response.statusText);\n          location.assign(\"/login\");\n        } else if (response.status === 403) {\n          alert(response.statusText);\n          history.back()\n        } else\n          alert(response.statusText);\n      }\n    };\n\n    const nextPage = (currentPage) => {\n      fetchPage(currentPage);\n      currentFirstPage.value += 3;\n      currentLastPage.value += 3;\n    };\n\n    return {\n      items,\n      pages,\n      currentFirstPage,\n      currentLastPage,\n      fetchPage,\n      nextPage,\n    };\n  },\n};\n</script>\n\n<style scoped>\n.pagination-group {\n  margin-top: 20px;\n}\n\n.card {\n  margin-bottom: 10px;\n}\n\n.btn {\n  margin-right: 10px;\n  margin-bottom: 10px;\n}\n\n.card-body {\n  background-color: white;\n}\n\n.banner-img {\n  padding: 5px 5px 0;\n}\n\n.header {\n  border-bottom: 1px solid #ebeff2;\n  padding: 19px 0;\n  text-align: center;\n  color: #59687f;\n  font-size: 600;\n  font-size: 19px;\n  position: relative;\n  font-weight: 700;\n}\n\n.banner-img img {\n  width: 100%;\n  border-radius: 5px;\n}\n\n.dates {\n  border: 1px solid #ebeff2;\n  border-radius: 5px;\n  padding: 20px 0px;\n  margin: 10px 20px;\n  font-size: 16px;\n  color: #5aadef;\n  font-weight: 600;\n  overflow: auto;\n}\n\n.dates div {\n  float: left;\n  width: 100%;\n  text-align: center;\n  position: relative;\n}\n\n.dates span {\n  width: 1px;\n  height: 40px;\n  position: absolute;\n  right: 0;\n  top: 0;\n  background: #ebeff2;\n}\n\n.dates strong,\n.stats strong {\n  display: block;\n  color: #adb8c2;\n  font-size: 11px;\n  font-weight: 700;\n}\n\n.stats {\n  border-top: 1px solid #ebeff2;\n  background: #f7f8fa;\n  overflow: auto;\n  padding: 15px 0;\n  font-size: 16px;\n  color: #59687f;\n  font-weight: 600;\n  border-radius: 0 0 5px 5px;\n}\n\np.card-text {\n  text-align: center;\n  font-weight: 600;\n}\n\n.stats div {\n  border-right: 1px solid #ebeff2;\n  width: 50%;\n  float: left;\n  text-align: center;\n}\n\n.stats div:nth-of-type(2) {\n  border: none;\n}\n\ndiv.footer {\n  text-align: right;\n  position: relative;\n  margin: 20px 5px;\n}\n\ndiv.footer a.btn {\n  padding: 10px 25px;\n  margin: 10px 2px;\n  font-weight: bold;\n  text-decoration: none;\n  border-radius: 3px;\n}\n</style>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}