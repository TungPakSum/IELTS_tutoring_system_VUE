{"ast":null,"code":"import \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.slice.js\";\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, resolveComponent as _resolveComponent, createBlock as _createBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, normalizeClass as _normalizeClass, withCtx as _withCtx, createVNode as _createVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nvar _withScopeId = function _withScopeId(n) {\n  return _pushScopeId(\"data-v-ed00baee\"), n = n(), _popScopeId(), n;\n};\nvar _hoisted_1 = {\n  \"class\": \"card-group row\"\n};\nvar _hoisted_2 = {\n  \"class\": \"card\"\n};\nvar _hoisted_3 = {\n  \"class\": \"card-body\"\n};\nvar _hoisted_4 = {\n  \"class\": \"card-title\"\n};\nvar _hoisted_5 = {\n  \"class\": \"list-group list-group-flush\"\n};\nvar _hoisted_6 = {\n  \"class\": \"list-group-item\"\n};\nvar _hoisted_7 = {\n  \"class\": \"list-group-item\"\n};\nvar _hoisted_8 = {\n  \"class\": \"list-group-item\"\n};\nvar _hoisted_9 = {\n  \"class\": \"card-body\"\n};\nvar _hoisted_10 = [\"onClick\"];\nvar _hoisted_11 = [\"onClick\"];\nvar _hoisted_12 = [\"onClick\"];\nvar _hoisted_13 = {\n  \"class\": \"pagination-group row\"\n};\nvar _hoisted_14 = {\n  \"aria-label\": \"Page navigation example\"\n};\nvar _hoisted_15 = {\n  \"class\": \"pagination\"\n};\nvar _hoisted_16 = /*#__PURE__*/_withScopeId(function () {\n  return /*#__PURE__*/_createElementVNode(\"li\", {\n    \"class\": \"page-item\"\n  }, [/*#__PURE__*/_createElementVNode(\"a\", {\n    \"class\": \"page-link\",\n    href: \"#\",\n    \"aria-label\": \"Previous\"\n  }, [/*#__PURE__*/_createElementVNode(\"span\", {\n    \"aria-hidden\": \"true\"\n  }, \"«\")])], -1 /* HOISTED */);\n});\nvar _hoisted_17 = [\"onClick\"];\nvar _hoisted_18 = /*#__PURE__*/_withScopeId(function () {\n  return /*#__PURE__*/_createElementVNode(\"a\", {\n    \"class\": \"page-link\",\n    \"aria-label\": \"Next\"\n  }, [/*#__PURE__*/_createElementVNode(\"span\", {\n    \"aria-hidden\": \"false\"\n  }, \"»\")], -1 /* HOISTED */);\n});\nvar _hoisted_19 = [_hoisted_18];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  var _component_QrCode = _resolveComponent(\"QrCode\");\n  var _component_router_link = _resolveComponent(\"router-link\");\n  return _openBlock(), _createElementBlock(_Fragment, null, [_createElementVNode(\"div\", _hoisted_1, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.items, function (item) {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: item,\n      \"class\": \"col-sm-4\"\n    }, [_createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, [item.type.type === 'individual' ? (_openBlock(), _createBlock(_component_QrCode, {\n      key: 0,\n      data: _ctx.getBag(item._id)\n    }, null, 8 /* PROPS */, [\"data\"])) : _createCommentVNode(\"v-if\", true), _createElementVNode(\"h5\", _hoisted_4, _toDisplayString(item.username), 1 /* TEXT */), _createElementVNode(\"ul\", _hoisted_5, [_createElementVNode(\"li\", {\n      \"class\": _normalizeClass([\"list-group-item h5 fw-bold\", {\n        'text-success': item.type.type === 'individual',\n        'text-primary': item.type.type === 'group'\n      }])\n    }, _toDisplayString(item.type.name), 3 /* TEXT, CLASS */), _createElementVNode(\"li\", _hoisted_6, \" 聯絡電話: \" + _toDisplayString(item.phoneNumber), 1 /* TEXT */), _createElementVNode(\"li\", _hoisted_7, \" 聯絡電郵: \" + _toDisplayString(item.email), 1 /* TEXT */), _createElementVNode(\"li\", _hoisted_8, \" 賣旗地點: \" + _toDisplayString(item.serviceLocation), 1 /* TEXT */)]), _createElementVNode(\"div\", _hoisted_9, [item.type.type !== 'individual' ? (_openBlock(), _createBlock(_component_router_link, {\n      key: 0,\n      to: \"/events/\".concat(_ctx.eid, \"/stations/\").concat(_ctx.sid, \"/volunteers/\").concat(item._id, \"/flagbags\"),\n      custom: \"\"\n    }, {\n      \"default\": _withCtx(function (_ref) {\n        var navigate = _ref.navigate;\n        return [_createElementVNode(\"a\", {\n          href: \"#\",\n          \"class\": \"btn btn-success\",\n          onClick: navigate\n        }, \"旗袋\", 8 /* PROPS */, _hoisted_10)];\n      }),\n      _: 2 /* DYNAMIC */\n    }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"to\"])) : _createCommentVNode(\"v-if\", true), _createVNode(_component_router_link, {\n      to: \"/events/\".concat(_ctx.eid, \"/stations/\").concat(_ctx.sid, \"/volunteers/\").concat(item._id),\n      custom: \"\"\n    }, {\n      \"default\": _withCtx(function (_ref2) {\n        var navigate = _ref2.navigate;\n        return [_createElementVNode(\"a\", {\n          href: \"#\",\n          \"class\": \"btn btn-success\",\n          onClick: navigate\n        }, \"編緝\", 8 /* PROPS */, _hoisted_11)];\n      }),\n      _: 2 /* DYNAMIC */\n    }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"to\"]), _createElementVNode(\"a\", {\n      href: \"#\",\n      \"class\": \"btn btn-danger\",\n      onClick: function onClick($event) {\n        return _ctx.deleteVolunteers(item._id);\n      }\n    }, \"刪除\", 8 /* PROPS */, _hoisted_12)])])])]);\n  }), 128 /* KEYED_FRAGMENT */))]), _createElementVNode(\"div\", _hoisted_13, [_createElementVNode(\"nav\", _hoisted_14, [_createElementVNode(\"ul\", _hoisted_15, [_hoisted_16, (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.pages.slice(_ctx.currentFirstPage, _ctx.currentLastPage), function (i) {\n    return _openBlock(), _createElementBlock(\"li\", {\n      key: i,\n      \"class\": \"page-item\"\n    }, [_createElementVNode(\"a\", {\n      \"class\": \"page-link\",\n      onClick: function onClick($event) {\n        return _ctx.fetchPage(i);\n      }\n    }, _toDisplayString(i), 9 /* TEXT, PROPS */, _hoisted_17)]);\n  }), 128 /* KEYED_FRAGMENT */)), _createElementVNode(\"li\", {\n    \"class\": \"page-item\",\n    onClick: _cache[0] || (_cache[0] = function ($event) {\n      return _ctx.nextPage(_ctx.i);\n    })\n  }, _hoisted_19)])])])], 64 /* STABLE_FRAGMENT */);\n}","map":{"version":3,"names":["_createElementVNode","href","_hoisted_18","_hoisted_1","_createElementBlock","_Fragment","_renderList","_ctx","items","item","key","_hoisted_2","_hoisted_3","type","_createBlock","_component_QrCode","data","getBag","_id","_hoisted_4","_toDisplayString","username","_hoisted_5","_normalizeClass","name","_hoisted_6","phoneNumber","_hoisted_7","email","_hoisted_8","serviceLocation","_hoisted_9","_component_router_link","to","concat","eid","sid","custom","_ref","navigate","onClick","_hoisted_10","_createVNode","_ref2","_hoisted_11","$event","deleteVolunteers","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","pages","slice","currentFirstPage","currentLastPage","i","fetchPage","_hoisted_17","_cache","nextPage"],"sources":["/Users/paksumtung/Documents/COMP4117/comp4117-spring2023-frontend-group-d/src/components/VolunteersCard.vue"],"sourcesContent":["<template>\n  <div class=\"card-group row\">\n    <div\n      v-for=\"item in items\" \n      :key=\"item\" \n      class=\"col-sm-4\"\n    >\n      <div class=\"card\">\n        <div class=\"card-body\">\n          <QrCode :data=\"getBag(item._id)\" \n          v-if=\"item.type.type === 'individual'\"></QrCode>\n          <h5 class=\"card-title\">\n            {{ item.username }}\n          </h5>\n          <ul class=\"list-group list-group-flush\">\n            <li class=\"list-group-item h5 fw-bold\"\n            :class=\"{'text-success': item.type.type === 'individual',\n                      'text-primary': item.type.type === 'group'}\">\n              {{ item.type.name }}\n            </li>\n\n            <li class=\"list-group-item\">\n              聯絡電話: {{ item.phoneNumber }}\n            </li>\n            <li class=\"list-group-item\">\n              聯絡電郵: {{ item.email }}\n            </li>\n            \n            <li class=\"list-group-item\">\n              賣旗地點: {{ item.serviceLocation }}\n            </li>\n          </ul>\n          <div class=\"card-body\">\n            <router-link\n              v-if = \"item.type.type !== 'individual'\"\n              v-slot=\"{ navigate }\"\n              :to=\"`/events/${eid}/stations/${sid}/volunteers/${item._id}/flagbags`\"\n              custom\n            >\n              <a\n                href=\"#\"\n                class=\"btn btn-success\"\n                @click=\"navigate\"\n              >旗袋</a>\n            </router-link>\n            <router-link\n              v-slot=\"{ navigate }\"\n              :to=\"`/events/${eid}/stations/${sid}/volunteers/${item._id}`\"\n              custom\n            >\n              <a\n                href=\"#\"\n                class=\"btn btn-success\"\n                @click=\"navigate\"\n              >編緝</a>\n            </router-link>\n            <a\n            href=\"#\"\n            class=\"btn btn-danger\"\n            @click=\"deleteVolunteers(item._id)\"\n            >刪除</a>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <div class=\"pagination-group row\">\n    <nav aria-label=\"Page navigation example\">\n      <ul class=\"pagination\">\n        <li class=\"page-item\">\n          <a\n            class=\"page-link\"\n            href=\"#\"\n            aria-label=\"Previous\"\n          >\n            <span aria-hidden=\"true\">&laquo;</span>\n          </a>\n        </li>\n        <li\n          v-for=\"i in pages.slice(currentFirstPage, currentLastPage)\"\n          :key=\"i\"\n          class=\"page-item\"\n        >\n          <a\n            class=\"page-link\"\n            @click=\"fetchPage(i)\"\n          >{{ i }}</a>\n        </li>\n        <li\n          class=\" page-item\"\n          @click=\"nextPage(i)\"\n        >\n          <a\n            class=\"page-link\"\n            aria-label=\"Next\"\n          >\n            <span aria-hidden=\"false\">&raquo;</span>\n          </a>\n        </li>\n      </ul>\n    </nav>\n  </div>\n</template>\n\n<script>\nimport {ref, onMounted, computed} from 'vue'\nimport {useRoute} from 'vue-router';\nimport QrCode from \"@/components/QrCode.vue\";\n\n\n\nexport default {\n  name: 'VolunteersCard',\n  components:\n  {\n    QrCode\n  },\n  setup: function () {\n    const lastPage = ref(0)\n    const perPage = ref(6);\n    const router = useRoute();\n    const eid = ref();\n    const sid = ref();\n    let currentFirstPage = ref(1);\n    let currentLastPage = ref(3);\n    let items = ref([]);\n    //let flagbagitems = ref([]);\n\n\n    onMounted(function () {\n      fetchPage(1);\n      getIds();\n      currentFirstPage.value = 0;\n      currentLastPage.value = 3;\n    });\n\n    const pages = computed(() => {\n      let pages = [];\n      for (let i = 1; i <= lastPage.value; i++) {\n        pages.push(i)\n      }\n      return pages;\n    })\n\n    const deleteVolunteers = async function (id) {\n      const response1 = await fetch(`/api/volunteers/delete/${id}`, {\n        method: \"delete\",\n        body: JSON.stringify(items.value),\n      });\n\n      const response2 = await fetch(`/api/flagbags/delete/${id}`, {\n        method: \"delete\",\n      });\n\n      if (response1 && response2.ok) {\n        alert(\"Flagbag deleted\");\n        location.assign(\"/events/\" + eid.value + \"/stations/\" + sid.value + \"/volunteers\");\n      } else {\n        alert(response.statusText);\n      }\n    };\n\n    const fetchPage = async function (page) {\n      const response = await fetch(`/api/volunteers/get?perPage=${perPage.value}&page=${page}`);\n      if (response.ok) {\n        let data = await response.json()\n        items.value = data.items\n        lastPage.value = data.pages\n        console.log(data.items)\n      } else {\n        alert(response.statusText)\n      }\n    }\n\n    const getBag = async function(vid)\n    {\n        try {\n        const response = await fetch(`/api/flagbags/getFromVid/${vid}`);\n        if (response.ok) {\n          const data = await response.json();\n          console.log(data);\n          const bag = data.item;\n          console.log(bag);\n          return bag;\n        } else {\n          throw new Error(`Error: ${response.status}`);\n        }\n      } catch (error) {\n        console.error(error);\n        return null; // or handle the error in another way\n      }\n        \n    }\n\n    \n\n    const getIds = function () {\n      eid.value = router.params.eid;\n      sid.value = router.params.sid;\n    }\n\n    const nextPage = (currentPage) => {\n      fetchPage(currentPage);\n      currentFirstPage.value += 3;\n      currentLastPage.value += 3;\n    };\n\n    return {\n      eid,\n      sid,\n      items,\n      pages,\n      currentFirstPage,\n      currentLastPage,\n      fetchPage,\n      nextPage,\n      deleteVolunteers,\n      getBag,\n      \n      \n    };\n  },\n};\n</script>\n<style scoped>\n.pagination-group {\n  margin-top: 20px;\n}\n\n.card {\n  margin-bottom: 10px;\n  \n  \n}\n\n.btn {\n  margin-right: 10px;\n  margin-bottom: 10px;\n}\n\n\n</style>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}